<div class="project-card">
  {% if project.redirect_to %}
    <a href="{{ project.redirect_to }}" class="card-link" target="_blank" rel="noopener noreferrer">
  {% else %}
    <a href="{{ project.url }}" class="card-link">
  {% endif %}
    {% assign card_title = project.name | default: project.title %}
    <div class="card-image-container">
      {% if project.preview_gif %}
        {% assign ext = project.preview_gif | split: '.' | last | downcase %}
        {% assign is_absolute = project.preview_gif contains '://' %}
        {% if is_absolute %}
          {% assign preview_src = project.preview_gif %}
        {% else %}
          {% assign preview_src = project.preview_gif | relative_url %}
        {% endif %}
        {% assign is_video = ext == 'mp4' or ext == 'mov' or ext == 'webm' %}
        {% assign is_common_image = ext == 'png' or ext == 'jpg' or ext == 'jpeg' or ext == 'gif' or ext == 'webp' %}
        {% if is_video or (project.preview_gif contains 'user-attachments/assets' and is_common_image == false) %}
          <video class="card-gif" autoplay loop muted playsinline preload="metadata" style="width:100%;height:auto;">
            <source src="{{ preview_src }}" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        {% else %}
          <img
            src="{{ preview_src }}"
            alt="{{ card_title }}"
            class="card-gif"
            loading="lazy"
          >
        {% endif %}
      {% elsif project.image %}
        <img
          src="{{ project.image | relative_url }}"
          alt="{{ card_title }}"
          class="card-gif"
          loading="lazy"
        >
      {% endif %}

      <div class="card-overlay">
        <span class="view-project-text">View Project</span>
      </div>
    </div>

    <div class="card-content">
      <h3 class="card-title">{{ card_title }}</h3>

      {% if project.description %}
      <div class="project-overview">
        {{ project.description }}
      </div>
      {% endif %}

      {% if project.tags %}
      <div class="card-tags">
        {% for tag in project.tags %}
        <span class="tag">{{ tag }}</span>
        {% endfor %}
      </div>
      {% endif %}

      {% if project.tools %}
      <div class="card-tags">
        {% for tool in project.tools %}
        <span class="tag">{{ tool }}</span>
        {% endfor %}
      </div>
      {% endif %}
    </div>
  </a>
</div>
